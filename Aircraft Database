CREATE TABLE AIRCRAFT (
AID INT,
ANAME VARCHAR(15),
CRUISINGRANGE INT,
PRIMARY KEY (AID));

CREATE TABLE FLIGHTS (
FLIGHT_NUM INT,
SOURCE VARCHAR(15),
DESTINATION VARCHAR(15),
DISTANCE INT,
DEPARTS VARCHAR(05),
ARRIVES VARCHAR(05),
PRICES INT,
PRIMARY KEY(FLIGHT_NUM),
FOREIGN KEY (FLIGHT_NUM) REFERENCES AIRCRAFT(AID) ON DELETE CASCADE);

CREATE TABLE EMPLOYEES(
EMP_ID VARCHAR(10),
ENAME VARCHAR(15),
SALARY INT,
PRIMARY KEY (EMP_ID));

CREATE TABLE CERTIFIED(
EMP_ID VARCHAR(10),
AID INT,
PRIMARY KEY(EMP_ID,AID),
FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEES(EMP_ID) ON DELETE CASCADE,
FOREIGN KEY (AID) REFERENCES AIRCRAFT(AID) ON DELETE CASCADE);



INSERT INTO AIRCRAFT VALUES(1, 'Air India', 5000);
INSERT INTO AIRCRAFT VALUES(2, 'Boeing 747', 4800);
INSERT INTO AIRCRAFT VALUES(3, 'Airbus A380', 3500);
INSERT INTO AIRCRAFT VALUES(4, 'Boeing 787', 1800);
INSERT INTO AIRCRAFT VALUES(5, 'Jet Airways', 2800);

INSERT INTO FLIGHTS VALUES(1, 'MANGALURU', 'LONDON', 4600, '12:00', '8:00', 150000);
INSERT INTO FLIGHTS VALUES(2, 'BENGALURU', 'MUMBAI', 1000, '1:00', '5:30', 45000);
INSERT INTO FLIGHTS VALUES(5, 'NEW DELHI', 'MUMBAI', 1500, '11:30', '19:00', 48000);
INSERT INTO FLIGHTS VALUES(3, 'BENGALURU', 'NEW DELHI', 900, '10:00', '12:00', 15400);
INSERT INTO FLIGHTS VALUES(4, 'BENGALURU', 'NEW DELHI', 500, '6:30', '8:25', 10000);

INSERT INTO EMPLOYEES VALUES('E1', 'VEJA', 170000);
INSERT INTO EMPLOYEES VALUES('E2', 'PRIYANKSHEE', 135000);
INSERT INTO EMPLOYEES VALUES('E3', 'SHRAVYA', 18000);
INSERT INTO EMPLOYEES VALUES('E4', 'SMRITHI', 58000);
INSERT INTO EMPLOYEES VALUES('E5', 'SRUJANA', 68000);
INSERT INTO EMPLOYEES VALUES('E6', 'DIVYA', 98000);

INSERT INTO CERTIFIED VALUES('E1', 1);
INSERT INTO CERTIFIED VALUES('E1', 2);
INSERT INTO CERTIFIED VALUES('E1', 3);
INSERT INTO CERTIFIED VALUES('E1', 4);
INSERT INTO CERTIFIED VALUES('E1', 5);
INSERT INTO CERTIFIED VALUES('E2', 2);
INSERT INTO CERTIFIED VALUES('E3', 1);
INSERT INTO CERTIFIED VALUES('E3', 3);
INSERT INTO CERTIFIED VALUES('E4', 1);
INSERT INTO CERTIFIED VALUES('E4', 2);
INSERT INTO CERTIFIED VALUES('E4', 3);
INSERT INTO CERTIFIED VALUES('E5', 1);
INSERT INTO CERTIFIED VALUES('E5', 4);
INSERT INTO CERTIFIED VALUES('E3', 4);
INSERT INTO CERTIFIED VALUES('E3', 2);


SELECT DISTINCT A.ANAME
FROM AIRCRAFT A, CERTIFIED C, EMPLOYEES E
WHERE A.AID=C.AID AND C.EMP_ID =E.EMP_ID AND E.SALARY >80000;


SELECT C.EMP_ID, MAX(A.CRUISINGRANGE)
FROM AIRCRAFT A, CERTIFIED C
WHERE A.AID=C.AID
GROUP BY EMP_ID HAVING COUNT(C.AID)>3;


SELECT DISTINCT ENAME 
FROM EMPLOYEES E,FLIGHTS F
WHERE E.SALARY < ( SELECT MIN(PRICES)
FROM FLIGHTS
WHERE SOURCE='BENGALURU' AND DESTINATION='MUMBAI');

SELECT A.AID
FROM AIRCRAFT A , FLIGHTS F
WHERE A.AID=F.FLIGHT_NUM AND F.SOURCE='BENGALURU' AND
F.DESTINATION= 'NEW DELHI';

SELECT ENAME, SALARY
FROM EMPLOYEES
WHERE SALARY = (SELECT MAX(SALARY)
               FROM EMPLOYEES
               WHERE SALARY < (SELECT MAX(SALARY) FROM EMPLOYEES));
